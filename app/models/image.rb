class Image < ActiveRecord::Base
  versioned :dependent => :tracking
#--------------------------------------------------------------------------------------------------------------------------------

  include CommonStuff
  include Publishable

#--------------------------------------------------------------------------------------------------------------------------------
#--------------------------------------------------------------------------------------------------------------------------------

  #--- associations
  has_many :image_attachments
  
  #--- validations
  validates_presence_of   :name
  validates_uniqueness_of :name

  #--- callbacks
  after_save :before_save_tasks
  
#--------------------------------------------------------------------------------------------------------------------------------
#--------------------------------------------------------------------------------------------------------------------------------

  def disable_all_others(newest)
    self.image_attachments.each do |ia|
      ia.disable_me unless ia == newest
    end
  end

#--------------------------------------------------------------------------------------------------------------------------------
#--------------------------------------------------------------------------------------------------------------------------------
private

  def before_save_tasks
    self.title = self.name if self.title.blank?
  end

#--------------------------------------------------------------------------------------------------------------------------------
#--------------------------------------------------------------------------------------------------------------------------------
end
